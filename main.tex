\documentclass[a4paper,10pt,reqno]{amsart}

\usepackage[utf8]{inputenc}
\usepackage[foot]{amsaddr}
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathrsfs,bm}
\usepackage[margin=0.95in]{geometry}
\usepackage{color}
\usepackage[dvipsnames]{xcolor}
\usepackage{cancel}
\usepackage{empheq}
\usepackage{float}



\input{toc-config.tex}

\usepackage{mathtools,enumerate,mathrsfs,graphicx}
\usepackage{epstopdf}
\usepackage{hyperref}
\usepackage[dvipsnames]{xcolor}

\usepackage{latexsym}


\definecolor{CommentGreen}{rgb}{0.0,0.4,0.0}
\definecolor{Background}{rgb}{0.9,1.0,0.85}
\definecolor{lrow}{rgb}{0.914,0.918,0.922}
\definecolor{drow}{rgb}{0.725,0.745,0.769}
\definecolor{grey}{RGB}{240,240,240}

\usepackage{listings}
\usepackage{textcomp}
\lstloadlanguages{Matlab}%
\lstset{
    language=Matlab,
    upquote=true, frame=single,
    basicstyle=\small\ttfamily,
    backgroundcolor=\color{Background},
    keywordstyle=[1]\color{blue}\bfseries,
    keywordstyle=[2]\color{purple},
    keywordstyle=[3]\color{black}\bfseries,
    identifierstyle=,
    commentstyle=\usefont{T1}{pcr}{m}{sl}\color{CommentGreen}\small,
    stringstyle=\color{purple},
    showstringspaces=false, tabsize=5,
    morekeywords={properties,methods,classdef},
    morekeywords=[2]{handle},
    morecomment=[l][\color{blue}]{...},
    numbers=none, firstnumber=1,
    numberstyle=\tiny\color{blue},
    stepnumber=1, xleftmargin=10pt, xrightmargin=10pt
}

\numberwithin{equation}{section}
\synctex=1

\hypersetup{
    unicode=false, pdftoolbar=true, 
    pdfmenubar=true, pdffitwindow=false, pdfstartview={FitH}, 
    pdftitle={ELE2024 Coursework}, pdfauthor={A. Author},
    pdfsubject={ELE2024 coursework}, pdfcreator={A. Author},
    pdfproducer={ELE2024}, pdfnewwindow=true,
    colorlinks=true, linkcolor=red,
    citecolor=blue, filecolor=magenta, urlcolor=cyan
}


% CUSTOM COMMANDS
\renewcommand{\Re}{\mathbf{re}}
\renewcommand{\Im}{\mathbf{im}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\lap}{\mathscr{L}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\smallmat}[1]{\left[ \begin{smallmatrix}#1 \end{smallmatrix} \right]}

%opening
\title[ELE2024 Coursework]{ELE2024 Control Coursework}

\author[J. Boden]{John Boden}
\author[J. Tutty]{Jonathan Tutty}
\author[S. Paine]{Simon Paine}

\address[J. Boden, J. Tutty and S. Paine]{Email addresses: \href{mailto:jboden03@qub.ac.uk}{jboden03@qub.ac.uk},
\href{mailto:jtutty01@qub.ac.uk}{jtutty01@qub.ac.uk} and
\href{mailto:spaine01@qub.ac.uk}{spaine01@qub.ac.uk}.}
\thanks{Link to Git Hub code:.... 
        Version 0.0.1. Last updated:~\today.}
\begin{document}

\maketitle

\section{Part A}

NOTE: CTRL + F9 is the shortcut to compile on Papeeria
% * <jboden03@qub.ac.uk> 12:28:30 04 Dec 2020 UTC+0000:
% This is useful
% ^ <Jonathan Tutty> 15:11:46 05 Dec 2020 UTC+0000:
% Good to know, ty

\subsection{Problem A1}\label{sec:a1}
% * <jboden03@qub.ac.uk> 14:10:20 04 Dec 2020 UTC+0000:
% NB. I have collapsed Part A1 - it is here
The objective of this question was to use the information provided in the problem description to derive a system of ordinary differential equation describing how the input voltage, V, affects the position, $x$, of the ball on the inclined plane.
\newline An inerital frame of reference was introduced where counterclockwise rotations were taken to be positive as shown in Figure \ref{fig:system}.

\begin{figure}[h]
\centering
\includegraphics[width=10cm]{figures/courseworktemplate3}
\caption{The system of a wooden ball on an inclined plane, involving a spring, damper and electromagnet controlled by a voltage V. Resolved forces are indicated in green.}
\label{fig:system}
\end{figure}

\newline Initally, we can derive an equation to represent the static friction, $T$, acting on the system as follows:
\newline It is known that the friction creates a torque on the ball with respect to its centre of mass. From Figure xyz, we can see this is equal to the Friction multiplied by the radius, i.e. $Tr$. 
\newline Applying Newton's law for rotational motion leads to the following equation:

\begin{align}
\label{1.1}
Tr &= I\ddot{\theta}
\end{align}

\newline where \ddot{\theta} represents the ball's angular acceleration. Recalling that the angular acceleration and linear acceleration, \ddot{x}, are linked by the following equation:

\begin{align}
\ddot{x} &= \ddot{\theta}r \label{1.2} \\
\intertext{Rearranging, we see that:}
\ddot{\theta} &= \frac{\ddot{x}}{r} \label{1.3}
\end{align}

\newline Substitution of \ref{1.3} into \ref{1.1} leads to the following equation for the friction:

\begin{align}
Tr &= I\bigg(\frac{\ddot{x}}{r}\bigg)\nonumber\\ 
Tr &= \frac{I_n\ddot{x}}{r} \nonumber \\ 
\intertext{therefore:}
T &= \frac{I_n\ddot{x}}{r^2} \label{1.4}
\end{align}

\newline We can also substitute for $I_n$, the moment of inertia of the ball. 
\newline For a ball where an axis runs through its centre, $I_n = \frac{2}{5}mr^2$.
\newline The equation for friction therefore becomes:

\begin{align}
T &= \frac{\frac{2}{5}m\cancel{r^2}\ddot{x}}{\cancel{r^2}} \nonumber \\
T &= \frac{2}{5}m\ddot{x} \label{1.5}
\end{align}
\vspace{3mm}

\newline A system of ordinary differential equations that describe the system can now be derived as follows:
\begin{align}
F_{mag} + mg\sin(\phi) - b\dot{x} - k(x - d) - T &= m\ddot{x} \nonumber \\
c \frac{I^2}{y^2} + mg\sin(\phi) - b\dot{x} - k(x - d) - T &= m\ddot{x} \nonumber \\
\intertext{substituting for T and also for y:}
c \frac{I^2}{(\delta - x)^2} + mg\sin(\phi) - b\dot{x} - k(x - d) - \frac{2}{5}m\ddot{x} &= m\ddot{x} \nonumber \\
c \frac{I^2}{(\delta - x)^2} + mg\sin(\phi) - b\dot{x} - k(x - d) &= m\ddot{x} + \frac{2}{5}m\ddot{x}\nonumber \\
c \frac{I^2}{(\delta - x)^2} + mg\sin(\phi) - b\dot{x} - k(x - d) &= \frac{7}{5}m\ddot{x}\nonumber
\end{align}

rearranging to determine $\ddot{x}$:

\begin{align}
\ddot{x} &= \frac{c \frac{I^2}{(\delta - x)^2} + mg\sin(\phi) - b\dot{x} - k(x-d)}{\frac{7}{5}m} \label{1.6}
\end{align}

rearranging this leads to an equation summarising the balls acceleration:

\begin{align}
\ddot{x} &= \frac{5}{7m}\bigg(c \frac{I^2}{(\delta - x)^2} + mg\sin(\phi) - b\dot{x} - k(x-d)\bigg) \label{1.7}
\end{align}

\newline From the circuit given in the problem ddescription, we can establish that:

\begin{align}
V = IR + L\dot{I} \nonumber \\
\intertext{therefore:}
\dot{I} = \frac{V - IR}{L} \label{1.8}
\end{align}

\newline From the problem description, we are told that:
\begin{align}
L = L_0 + L_1\exp(-\alpha y) \label{1.9}
\end{align}

\newline Substituting \ref{1.9} into \ref{1.8} leads to the following equation:

\begin{align}
\dot{I} = \frac{V - IR}{L_0 + L_1\exp(-\alpha y)} \label{1.10}
\end{align}

\newline In order to have the overal equations in terms of the variables $x$ and $V$ only, $y$ is replaced with the equivalent term `$\delta - x$':

\begin{align}
\dot{I} = \frac{V - IR}{L_0 + L_1\exp(-\alpha (\delta - x))} \label{1.11}
\end{align}

\newline Overall, we can describe the system using equations \ref{1.7} and \ref{1.11}

\subsection{Problem A2}\label{sec:a2}
We can now write the system in state space representation, using the two equations obtained in \ref{sec:a1}.

We can firstly define four new variables as follows:

\begin{align}
x_1 &= x \label{1.12} \\
x_2 &= \dot{x_1} (= \dot{x}) \label{1.13} \\
x_3 &= I \label{1.14}
\end{align}

\newline We can now rewrite \ref{1.7} and \ref{1.10} using these new variables as follows:

\begin{align}
\dot{x_2} &= \frac{5}{7m}\bigg(c \frac{{x_3}^2}{(\delta - x_1)^2} + mg\sin(\phi) - bx_2 - k(x_1-d)\bigg) \label{1.15} \\
\dot{x_3} &= \frac{V - x_3 R}{L_0 + L_1\exp(-\alpha y)} \label{1.16}
\end{align}

\newline Equations \ref{1.15} and \ref{1.16} can be used to express the system in a state space representation as follows:

\begin{align}
\begin{bmatrix}
\dot{x}
\end{bmatrix} 
= 
\begin{bmatrix}
\dot{x_1}\\
\dot{x_2}\\
\dot{x_3}
\end{bmatrix}
= 
\begin{bmatrix}
x_2 \\
\frac{5}{7m}\bigg(c \frac{{x_3}^2}{(\delta - x_1)^2} + mg\sin(\phi) - bx_2 - k(x_1-d)\bigg)\\
\frac{V - x_3 R}{L_0 + L_1\exp(-\alpha y)}
\end{bmatrix}
\label{1.17}
\end{align}

\newline The states of the system are $x_1$ and $x_2$, while the input is $x_3$, the current. All other terms in the equation are constants.



\subsection{Problem A3}\label{sec:a3}
The equlibrium points of the system are characterised in \ref{eq:eq_points}.

\begin{subequations}\label{eq:eq_points}
\begin{align}
      x^{eq}_{2} &= 0 \label{1.18a} \\
     \frac{5}{7m}\bigg(c \frac{({x_3}^{eq})^2}{(\delta - x_1^{eq})^2} + mg\sin(\phi) - bx_2^{eq} - k(x_1^{eq}-d)\bigg) &= 0 \label{1.18b} \\
     \frac{V - x_3^{eq}R}{L_0 + L_1\exp(-\alpha(\delta - x_1^{eq}))} &= 0 \label{1.18c}
\end{align}
\end{subequations}




\subsection{Problem A4}\label{sec:a4}
We subtract (\ref{1.13}) and (\ref{eq:eq_points}) by parts to obtain

\begin{subequations}
     \begin{align}
          \dot{x_1} &= x_2 - x_2^{eq} \\
          \dot{x_2} &=  \frac{5}{7m}\bigg(c \frac{{x_3}^2}{(\delta - x_1)^2} + mg\sin(\phi) - bx_2 - k(x_1-d)\bigg) - \frac{5}{7m}\left(c \frac{({x_3}^{eq})^2}{(\delta - x_1^{eq})^2} + mg\sin(\phi) - bx_2^{eq} - k(x_1^{eq}-d)\right) \label{eq:x2dot}\\
          \dot{x_3} &= \frac{V - x_3R}{L_0 + L_1\exp(-\alpha(\delta - x_1))} - \frac{V - x_3^{eq}R}{L_0 + L_1\exp(-\alpha(\delta - x_1^{eq}))} \label{eq:x3dot}
     \end{align}
\end{subequations}\newline
We define the functions

\begin{subequations}
    \begin{align}
         \phi(x_1, x_2, x_3) = \dot{x_2} &= \frac{5}{7m}\left[\frac{cx_3^2}{(\delta - x_2)^2} - \frac{c(x_3^{eq})^2}{(\delta - x_2^{eq})^2} - k(x_1 - x_1^{eq}) - b(x_2 - x_2^{eq})\right] \\
         \psi(V, x_1, x_3) = \dot{x_3} &= \frac{V - x_3R}{L_0 + L_1\exp(-\alpha(\delta - x_1))} - \frac{V^{eq} - x_3^{eq}R}{L_0 + L_1\exp(-\alpha(\delta - x_1^{eq}))}
    \end{align}
\end{subequations}

We linearised $\phi$ at an equlibrium $(x_1^{eq}, x_2^{eq}, x_3^{eq})$. Its partial derivatives with respect to $x_1, x_2$ and $x_3$ at the equlibrium point are

\begin{subequations}\label{eq:phiDeriv}
     \begin{align}
          \frac{\partial\phi}{\partial x_1}\Bigg|_{x_1^{eq}, x_2^{eq}, x_3^{eq}} &= \frac{5}{7 m}\left(\frac{2 c (x_3^{eq})^{2}}{\left(\delta - x_{1}^{eq}\right)^{3}} - k\right) \\
          \frac{\partial\phi}{\partial x_2}\Bigg|_{x_1^{eq}, x_2^{eq}, x_3^{eq}} &= - \frac{5 b}{7 m} \\
          \frac{\partial\phi}{\partial x_3}\Bigg|_{x_1^{eq}, x_2^{eq}, x_3^{eq}} &= \frac{10 c x_{3}^{eq}}{7 m \left(\delta - x_{1}^{eq}\right)^{2}}
     \end{align}
\end{subequations}

therefore, $\phi(x_1, x_2, x_3)$ can be approximated by
\begin{equation}
     \phi(x_1, x_2, x_3) \approx \frac{5}{7 m}\left(\frac{2 c (x_{3}^{eq})^{2}}{\left(\delta - x_{1}^{eq}\right)^{3}} - k\right)(x_1 - x_1^{eq}) - \frac{5 b}{7 m}(x_2 - x_2^{eq}) + \frac{10 c x_{3}^{eq}}{7 m \left(\delta - x_{1}^{eq}\right)^{2}}(x_3 - x_3^{eq})
\end{equation}

We linearised $\psi$ at an equlibrium $(V^{eq}, x_1^{eq}, x_3^{eq})$. Its partial derivatives with respect to $V, x_1$ and $x_3$ at the equlibrium point are

\begin{subequations}\label{eq:psiDeriv}
     \begin{align}
        \frac{\partial\psi}{\partial V}\Bigg|_{V^{eq}, x_1^{eq}, x_3^{eq}} &= \frac{1}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}} \\
          \frac{\partial\psi}{\partial x_2}\Bigg|_{V^{eq}, x_1^{eq}, x_3^{eq}} &= - \frac{L_{1} \alpha \left(- R x_{3}^{eq} + V\right) e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}{\left(L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}\right)^{2}} \\
          \frac{\partial\psi}{\partial x_3}\Bigg|_{V^{eq}, x_1^{eq}, x_3^{eq}} &= - \frac{R}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}
     \end{align}
\end{subequations}

therefore, $\psi(V, x_1, x_3)$ can be approximated by
\begin{equation}
     \psi(V, x_1, x_3) \approx \frac{1}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}(V - V^{eq}) - \frac{L_{1} \alpha \left(- R x_{3}^{eq} + V\right) e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}{\left(L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}\right)^{2}}(x_1 - x_1^{eq}) - \frac{R}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}(x_3 - x_3^{eq})
\end{equation}

N.B.: The code used to determine all the partial derivatives can be found at XYZ

We now introduce the deviation variables $\overline{x}_1 = x_1-x_1^{eq}, \overline{x}_2 = x_2-x_2^{eq}, \overline{x}_3 = x_3-x_3^{eq}$ and $\overline{V} = V-V^{eq}$. The linearised system then becomes

\begin{subequations}\label{eq:linear_system}
     \begin{align}
          \dot{\overline{x}}_1 &= \overline{x}_2 \\
          \dot{\overline{x}}_2 &= \frac{5}{7 m}\left(\frac{2 c (x_{3}^{eq})^{2}}{\left(\delta - x_{1}^{eq}\right)^{3}} - k\right)\overline{x}_1  - \frac{5 b}{7 m}\overline{x}_2 + \frac{10 c x_{3}^{eq}}{7 m \left(\delta - x_{1}^{eq}\right)^{2}}\overline{x}_3\\
          \dot{\overline{x}}_3 &= \frac{1}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}\overline{V} - \frac{L_{1} \alpha \left(- R x_{3}^{eq} + V\right) e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}{\left(L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}\right)^{2}}\overline{x}_1 - \frac{R}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}\overline{x}_3
     \end{align}
\end{subequations}

\subsection{Problem A5}\label{sec:a5}\hfill

\setlength{\jot}{5pt} % Increases spacing between equations

\begin{figure}[H]
% * <Jonathan Tutty> 16:26:09 07 Dec 2020 UTC+0000:
% I also added the "float" package so you can use "H" to force latex to put an image where you want it.
     \includegraphics[width = 0.5\textwidth]{figures/tf_block.eps}
     \caption{Block diagram of the system's tranfer function}
     \label{fig:tfBlock}
\end{figure}

The equation for the transfer function of a dynamical system is

\begin{equation}
     G(s) = \frac{X(s)}{U(s)} \label{eq:TF} \\
\end{equation}

\begin{center}
     where $X(s)$ is the input (s-domain), \\
     and $U(s)$ is the output (s-domain)
\end{center}
\vspace{10pt}

The transfer function of the system can be represented by the block diagram shown in figure \ref{fig:tfBlock}. In order to determine $G(s)$, some constants are defined for the partial derivatives calculated in equations \ref{eq:phiDeriv} and \ref{eq:psiDeriv} in order to simplify the linearised system expressed in equations \ref{eq:linear_system}

\begin{subequations} \label{eq:SysLT}
    \begin{align}
         A_1 &= \frac{5}{7 m}\left(\frac{2 c (x_{3}^{eq})^{2}}{\left(\delta - x_{1}^{eq}\right)^{3}} - k\right) \label{eq:A1} \\
         A_2 &= -\frac{5 b}{7 m} \label{eq:A2} \\
         A_3 &= \frac{10 c x_{3}^{eq}}{7 m \left(\delta - x_{1}^{eq}\right)^{2}} \label{eq:A3} \\
         \intertext{and}
         B_1 &= \frac{1}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}} \label{eq:B1} \\
         B_2 &= - \frac{L_{1} \alpha \left(- R x_{3}^{eq} + V\right) e^{- \alpha \left(\delta - x_{1}^{eq}\right)}}{\left(L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}\right)^{2}} \label{eq:B2} \\
         B_3 &= - \frac{R}{L_{0} + L_{1} e^{- \alpha \left(\delta - x_{1}^{eq}\right)}} \label{eq:B3}
    \end{align}
\end{subequations}
\vspace{1pt}

Then the Laplace transform is applied to equations \ref{eq:linear_system}. This gives

\begin{subequations} \label{eq:SysLT}
    \begin{align}
         s\overline{X}_1(s) &= \overline{X}_2(s) \label{eq:sX1} \\
         s\overline{X}_2(s) &= A_1(s)\overline{X}_1(s) + A_2(s)\overline{X}_2(s) + A_3(s)\overline{X}_3(s) \label{eq:sX2} \\
         s\overline{X}_3(s) &= B_1(s)\overline{V}(s) + B_2(s)\overline{X}_1(s) + B_3(s)\overline{X}_3(s) \label{eq:sX4}
    \end{align}
\end{subequations}
\vspace{1pt}

In order to find the tranfer function, an expression for $\overline{X}_1(s)$ in terms of $\overline{V}(s)$ must be found. To do this two expressions for $\overline{X}_3(s)$ can be found and then solved simultaneously.\\
The first expression is determined by substituting \ref{eq:sX1} into \ref{eq:sX2}

\begin{align*}
     s^2\overline{X}_1(s) &= A_1(s)\overline{X}_1(s) + A_2(s)\overline{X}_2(s) + A_3(s)\overline{X}_3(s) \\
     \iff s^2\overline{X}_1(s) &= A_1(s)\overline{X}_1(s) + sA_2(s)\overline{X}_1(s) + A_3(s)\overline{X}_3(s) \\
     \iff A_3(s)\overline{X}_3(s) &= s^2\overline{X}_1(s) - A_1(s)\overline{X}_1(s) - sA_2(s)\overline{X}_1(s)
\end{align*}
\vspace{1pt}

Therefore,

\begin{equation}
     \overline{X}_3(s) =\frac{s^2\overline{X}_1(s) - A_1(s)\overline{X}_1(s) - sA_2(s)\overline{X}_1(s)}{A_3(s)} \label{eq:X3_1}
\end{equation}
\vspace{1pt}

Likewise, the second expression is determined by rearranging \ref{eq:sX4}:

\begin{align*}
     s\overline{X}_3(s) &= B_1(s)\overline{V}(s) + B_2(s)\overline{X}_1(s) + B_3(s)\overline{X}_3(s) \\
     \iff s\overline{X}_3(s) - B_3(s)\overline{X}_3(s) &= B_1(s)\overline{V}(s) + B_2(s)\overline{X}_1(s) \\
     \iff \overline{X}_3(s)\left(s - B_3(s)\right) &= B_1(s)\overline{V}(s) + B_2(s)\overline{X}_1(s)
\end{align*}
\vspace{1pt}

Therefore,

\begin{equation}
     \overline{X}_3(s) &= \frac{B_1(s)\overline{V}(s) + B_2(s)\overline{X}_1(s)}{s - B_3(s)} \label{eq:X3_2}
\end{equation}
\vspace{1pt}

Equations \ref{eq:X3_1} and \ref{eq:X3_2} can now be solved simultaneously

\begin{align*}
     \frac{s^2\overline{X}_1(s) - A_1(s)\overline{X}_1(s) - sA_2(s)\overline{X}_1(s)}{A_3(s)} \label{eq:X3_1} &= \frac{B_1(s)\overline{V}(s) + B_2(s)\overline{X}_1(s)}{s - B_3(s)} \label{eq:X3_2} \\
     \iff \left(s^2\overline{X}_1(s) - A_1(s)\overline{X}_1(s) - sA_2(s)\overline{X}_1(s)\right) \left(s - B_3(s)\right) &= A_3(s)B_1(s)\overline{V}(s) + A_3(s)B_2(s)\overline{X}_1(s) \\
     \iff \overline{X}_1(s)\left(s^2 - A_1(s) - sA_2(s)\right) \left(s - B_3(s)\right) - A_3(s)B_2(s)\overline{X}_1(s) &= A_3(s)B_1(s)\overline{V}(s) \\
     \iff \overline{X}_1(s)\left[\left(s^2 - A_1(s) - sA_2(s)\right) \left(s - B_3(s)\right) - A_3(s)B_2(s)\right] &= A_3(s)B_1(s)\overline{V}(s)
\end{align*}
\vspace{1pt}

Therefore,

\begin{equation}
     \overline{X}_1(s) = \frac{A_3(s)B_1(s)\overline{V}(s)}{\bigl(s^2 - sA_2(s) - A_1(s)\bigr) \bigl(s - B_3(s)\bigr) - A_3(s)B_2(s)} \label{eq:X1}
\end{equation}
\vspace{1pt}

Using equation \ref{eq:TF}, and given that equation \ref{eq:X1} is the input and $\overline{V}(s)$ is the output, it can be seen that the transfer function of the system is

\begin{empheq}[box={\setlength{\fboxsep}{10pt}\colorbox{grey}}]{equation}\label{eq:SysTF}
% * <Jonathan Tutty> 15:45:52 07 Dec 2020 UTC+0000:
% I added the "empheq" package to emphasise the most important equations as I think it makes the report a bit easier to read.
% ^ <jboden03@qub.ac.uk> 15:21:05 29 Dec 2020 UTC+0000:
% smart thinking
         G(s) = \frac{\overline{X}_1(s)}{\overline{V}(s)} = \frac{A_3(s)B_1(s)}{\bigl(s^2 - sA_2(s) - A_1(s)\bigr) \bigl(s - B_3(s)\bigr) - A_3(s)B_2(s)}
\end{empheq}

\section{Part B}

\subsection{Problem B1}\label{sec:b1}
Include all info on start of B1 here. The following relates to the second half of B1:
We also need to determine the equilibrium voltage and current as a function of $x^e$. Using (\ref{1.18c}), we can determine the following:

\begin{align}
V - x_3^{eq}R &= 0 \nonumber \\
\Leftrightarrow x_3^{eq} &= \frac{V}{R} \label{eqn: x3eq}
\end{align}
where $x_3^{eq}$ is the equilibrium current.

From (\ref{1.18b}), which is rewritten below for clarity, we can determine the following:

\begin{align}
\frac{5}{7m}\bigg(c \frac{({x_3}^{eq})^2}{(\delta - x_1^{eq})^2} + mg\sin(\phi) - bx_2^{eq} - k(x_1^{eq}-d)\bigg) &= 0 \nonumber \\
\intertext{Either $\frac{5}{7m} = 0$ or the bracted section of the equation equals 0. As it is impossible for $\frac{5}{7m} = 0$ given the constant value of $m$, this leads to the following conclusion:}
c \frac{({x_3}^{eq})^2}{(\delta - x_1^{eq})^2} + mg\sin(\phi) - bx_2^{eq} - k(x_1^{eq}-d) &= 0 \nonumber \\
\intertext{Substituing for the constants, and given that from (\ref{1.18a})$x_2^eq = 0$}
\Leftrightarrow 6.815 \frac{({x_3}^{eq})^2}{(0.65 - x_1^{eq})^2} + (0.425)(9.81)\sin(42^\circ) - \cancelto{0}{bx_2^{eq}} - k(x_1^{eq}-d) &= 0 \nonumber \\
\Leftrightarrow 6.815 ({x_3}^{eq})^2 + 2.7898((0.65 - x_1^{eq})^2) - 1880(x_1^{eq}-0.42)((0.65 - x_1^{eq})^2) &= 0 \nonumber \\
\Leftrightarrow 6.815 (\frac{V}{R})^2 + 2.7898((x_1^{eq})^2) - 3.62674x_1^{eq} + 1.17869 - 1880((x_1^{eq})^3) + 3233.6((x_1^{eq})^2) \nonumber \\ - 1820.78x_1^{eq} + 333.606 &= 0 \nonumber \\
\Leftrightarrow 6.815 (\frac{V}{53})^2 + 2.7898((x_1^{eq})^2) - 3.62674x_1^{eq} + 1.17869 - 1880((x_1^{eq})^3) + 3233.6((x_1^{eq})^2) \nonumber \\ - 1820.78x_1^{eq} + 333.606 &= 0 \nonumber \\
\Leftrightarrow 1880((x_1^{eq})^3) - 3236.3898((x_1^{eq})^2) + 1824.40641(x_1^{eq} - 334.78469 &= \frac{6.815V^2}{2809} \nonumber \\
\Leftrightarrow \frac{2809}{6.815}\bigg(1880((x_1^{eq})^3) - 3236.3898((x_1^{eq})^2) + 1824.40641(x_1^{eq} - 334.78469 \bigg) &= V^2 \nonumber \\ 
\Leftrightarrow 774896.55((x_1^{eq})^3) - 1333971.97((x_1^{eq})^2) + 751982.01(x_1^{eq} - 137991.22 &= V^2 \label{eqn: B1deriv}
\end{align}
A plot of this equation is shown below.
\begin{figure}[h]
\centering
\includegraphics[width=10cm]{figures/ProblemB1}
\caption{A plot to determine the maximum equilibrium voltage, and the corresponding $x$-position.}
\label{fig:B1plot}
\end{figure}

From the plot, we can see that the maximum equilibrium voltage value is $37.0111$ V. The corresponding $x$-position where this maximum voltage occurs is $0.4976$ m.


We now need to linearise the system at the equilibrium point that corresponds to $x=0.75x_{min}+0.25x_{max}$.
This can be done by substituting the equations for $x_{min}$, $x_{max}$ into this equation along with any constants provided in the problem description as follows.

\begin{align}
x &= 0.75x_{min} + 0.25 x_{max}\nonumber \\
x_1^{eq} &= 0.75 \bigg(d + \frac{mg \sin{\phi}}{k}\bigg) + 0.25 \delta \nonumber \\
\intertext{therefore, substituting for the constant values:}
x_1^{eq} &= 0.75 \bigg(0.42 + \frac{(0.425)(9.81) \sin{(42 \circ)}}{1880}\bigg) + 0.25(0.65) \nonumber \\
x_1^{eq} &= 0.47861 \label{eqn: xvalue}
\end{align}

We can also determine the corresponding equilibrium voltage by substitution of $x_1^{eq}$ into (\ref{eqn: B1deriv}).
This leads to the following:
\begin{align}
(V^e)^2 &= 1300.24005 \nonumber \\
\leftrightarrow V^e &= \pm 36.0588 V \nonumber \\
\intertext{We will only consider the Voltage being a positive value, therefore}
\leftrightarrow V^e &= 36.0588 V \label{eqn: Ve value}
\end{align}



\subsection{Problem B2}\label{sec:b2}


\subsection{Problem B3}\label{sec:b3}


\subsection{Problem B4}\label{sec:b4}




\subsection{Problem B5}\label{sec:b5}

When designing a controller for the system that manipulates the voltage to steer the $x$-position of the ball towards a set point $x^{sp}$, it should meet some desired characteristics; the ball should move to the set point quickly and without oscillation, and it should not exhibit constant bias. To prove that the controller is good, a plot should be provided of the trajectory of $x(t)$ that clearly shows the aforementioned characteristics. For example, if it is specified that after 0.5~s, $x$ should not deviate more than 0.1~cm from $x^{sp}$, the graph should demonstrate this.

\section{Part C}

\subsection{Probelm C1}\label{sec:c1}
The following function is defined in the Problem Description:
\begin{align}
f(t) = \ln t^3, t>0 \label{eqn: C1function}
\end{align}
The general form of the Laplace Transform is as follows,
\begin{align}
F(s) = (\mathscr{L}f)(s) =  \int_{0}^{\infty} e^{-st}f(t) \,dt  \label{eqn: Laplace}
\end{align}
Application of this to our function, $f(t)$ leads to the following:
\begin{align}
F(s) &= \int_{0}^{\infty} e^{-st} \ln t^3 \,dt, s>0  \nolabel \\
\Leftrightarrow F(s) &= \int_{0}^{\infty} e^{-st} 3\ln t \,dt  \label{eqn: C1beginning}
\end{align}
Integrating (\ref{eqn: C1function}) by parts will not simplify the integral - rather it will lead to the contrary. Instead a substitution method can be applied as follows.
\begin{align}
\intertext{let}
u &=st \label{eqn: C1u} \\
\Leftrightarrow \frac{\mathrm{d}u}{\mathrm{d}t} &= s \nolabel \\
\Leftrightarrow \mathrm{d}t &= \frac{1}{s} \mathrm{d}u \label{eqn: c1dt}
\end{align}
The limits of the integral also need to be considered:
\begin{align*}
\intertext{from (\ref{eqn: C1u}), when}
t &= 0 \\
\intertext{then,}
u &= 0 
\end{align*}
Also, when
\begin{align*}
t \rightarrow \infty \\
\intertext{then,}
u \rightarrow \infty \\
\end{align*}
This indicates that the limits of the integral remain unchanged, provided $s>0$ as stated previously.
\begin{align}
\Leftrightarrow F(s) &= \int_{0}^{\infty} e^{-u} \textcolor{red}{3}\ln \bigg(\frac{u}{s}\bigg) \textcolor{red}{\frac{1}{s}} \,du  \nonumber \\
&= \textcolor{red}{\frac{3}{s}} \int_{0}^{\infty} e^{-u} \ln \bigg(\frac{u}{s}\bigg) \,du  \nonumber \\
&= \frac{3}{s} \int_{0}^{\infty} e^{-u} (\ln u - \ln s) \,du  \nonumber \\
&= \frac{3}{s} \bigg( \int_{0}^{\infty} e^{-u} \ln u \,du - \ln s  \int_{0}^{\infty} e^{-u} \,du \bigg) \nonumber \\
&= \frac{3}{s} \bigg(\bigg( \int_{0}^{\infty} e^{-u} \ln u \,du \bigg) + (\ln s) e^{-u} \bigg|_0^\infty \bigg) \nonumber \\
&= \frac{3}{s} \bigg(\bigg( \int_{0}^{\infty} e^{-u} \ln u \,du \bigg) + (\ln s) (0-1) \bigg) \nonumber \\
F(s)&= \frac{3}{s} \bigg(\bigg( \int_{0}^{\infty} e^{-u} \ln u \,du \bigg) - \ln s \bigg) \label{eqn: C1halfway}
\end{align}
Now, we need to introduce the Euler-Mascheroni constant which is defined as follows:
\begin{align}
\gamma = -\int_{0}^{\infty} e^{-x} \ln x \,dx \label{eqn: Euler-Mascheroni}
\end{align}
Application of (\ref{eqn: Euler-Mascheroni}) to (\ref{eqn: C1halfway}):
\begin{align}
F(s) &= \frac{3}{s} \bigg( -\gamma - \ln s \bigg) \nonumber \\
F(s) &= \frac{-3(\gamma + \ln s)}{s}, s>0 \label{eqn: C1final}
\end{align}
which is the Laplace transform of $f(t)$.


\subsection{Probelm C2}\label{sec:c2}

The following function is defined in the Problem Description:

\begin{equation}
    f(t) = |\cos(\omega t)|, t \geq 0, \omega > 0
\end{equation}

This is a periodic function with period $T = \pi$. Then, 

\begin{align}
f_0(t) &= |cos(\omega t)|(1 - H_\pi(t)) \\
&= \cos(\omega t)(1 - H_\pi(t)) \\
&= \cos(\omega t) - \cos(\omega t)H_\pi(t)
\end{align}

The Laplace transform of $f_0$ can be determined by applying Theorem 4.14 (Shifted (delayed) functions) which can be found on page 95 of the textbook.

\begin{align}
(\lap f_0)(s) &= \lap\{\cos(\omega t)\} - \lap\{\cos(\omega t)H_\pi(t)\} \\
&= \lap\{\cos(\omega t)\} - \lap\{\cos(\omega t - \pi)H_\pi(t)\}
\end{align}

Using the following property of Laplace transforms:
\begin{equation}
    \lap\left\{e(t - t_0)H_{t_0}(t)\right\} = e^{-t_0 s}\lap{w(t)}
\end{equation}

therefore

\begin{align}
     (\lap f_0)(s) &= \frac{s}{s^2 + \omega^2} - e^{-\pi s}\lap\{\cos(\omega t)\} \\
     &= \frac{s}{s^2 + \omega^2} - e^{-\pi s}\frac{s}{s^2 + \omega^2} \\
     &= \frac{s - e^{-\pi s}s}{s^2 + \omega^2} \\
     &= \frac{s(1 - e^{-\pi s})}{s^2 + \omega^2}
\end{align}

From Theorem 4.24 (Laplace transform of periodic function, v2) found on page 105 of the textbook

\begin{align}
(\lap|{\cos(\omega t)|})(s) &= \frac{1}{1 - e^{-\pi s}}\frac{s(1 - e^{-\pi s})}{s^2 + \omega^2} \\
&= \frac{s}{s^2 + \omega^2}
\end{align}


\subsection{Problem C3}\label{sec:c3}

It is given that

\begin{equation}\label{eq:pntwise_lap}
    \lim_{n \to \infty} \big(\lap\left\{f_n\right\}\big) = \lap\{f\}
\end{equation}
\vspace{1pt}

Let $f_n(t)$ be the sequence of time-domain functions, where

\begin{equation}
     f_n(t) = \frac{t}{n}
\end{equation}
\vspace{1pt}

then

\begin{subequations}
     \begin{align}
         \lim_{n \to \infty} \left(\frac{t}{n}\right) &\to 0 \\
         \therefore f(t) &= 0
     \end{align}
\end{subequations}
\vspace{1pt}

therefore, $f_n(t)$ converges pointwise to $f(t)$ for all $t\geq0$

\begin{subequations}
     \begin{align}
         F_n(s) &= \lap\left\{f_n\right\} \\
         &= \lap\left\{\frac{t}{n}\right\} \\
         &= \frac{1}{n} \lap\left\{t\right\} \\
         &= \frac{1}{n} \cdot \frac{1}{s^2} \\
         &= \frac{1}{ns^2}
    \end{align}
\end{subequations}
\vspace{1pt}

therefore, all $f_n(t)$ have a Laplace transform $F_n(s)$

\begin{equation}\label{eq:F}
     F(s) = \lap\{f\} = \lap\{0\} = 0
\end{equation}
\vspace{1pt}

therefore, f(t) has a Laplace transform F(s) \\

It can also be seen that this follows the rule in equation \ref{eq:pntwise_lap}, since

\begin{equation}
     \lim_{n \to \infty} \left(\frac{1}{ns^2}\right) = \frac{1}{s^2} \lim_{n \to \infty} \left(\frac{1}{n}\right) \to 0
\end{equation}
\vspace{1pt}

A counterexample to equation \ref{eq:pntwise_lap} is

\begin{equation}\label{eq:fn}
     f_n(t) = e^t\big(H_{n^2 - n}(t) - H_{n^2 + n}(t)\big)
\end{equation}
\vspace{1pt}

$f(t)$ can be calculated by applying the limit chain rule

\begin{equation}
     f(t) = \lim_{n \to \infty} \bigg(e^t\big(H_{n^2 - n}(t) - H_{n^2 + n}(t)\big)\bigg)
\end{equation}
\vspace{1pt}

let $u(n) = n^2 - n$, $w(n) = n^2 + n$, and $g(t) = e^t\big(H_u(t) - H_w(t)\big)$

\begin{subequations}
     \begin{align}
         \lim_{n \to \infty} (n^2 - n) &\to \infty \\
         \text{and } \lim_{n \to \infty} (n^2 + n) &\to \infty 
     \end{align}  
\end{subequations}
\vspace{1pt}

therefore

\begin{equation}
     f(t) = \lim_{n \to \infty} \bigg(e^t\big(H_{\infty}(t) - H_{\infty}(t)\big)\bigg)
\end{equation}
\vspace{1pt}

since $H_a(t)$ is defined as

\begin{equation}
    H_a(t) = 
     \begin{cases}
         0 & \text{if } t < a \\
         1 & \text{if } t > a
     \end{cases}
\end{equation}
\vspace{1pt}

therefore

\begin{equation}
     H_{\infty}(t) \equiv 0
\end{equation}

then

\begin{subequations}
     \begin{align}
          f(t) &= \lim_{n \to \infty} (e^t \cdot 0) \\
          \therefore f(t) &= 0 \\
          \text{and } F(s) &= 0 \label{eq:F}
     \end{align}
\end{subequations}
\vspace{1pt}

Now $F_n(s)$ must be found

\begin{equation}
     F_n(s) = \lap\left\{e^t H_{n^2 - n}(t) - e^t H_{n^2 + n}(t)\right\}
\end{equation}
\vspace{1pt}

Due to the linearity rule of Laplace transfroms this can be written as

\begin{equation}
     F_n(s) = \lap\left\{e^t H_{n^2 - n}(t)\right\} - \lap\left\{e^t H_{n^2 + n}(t)\right\}
\end{equation}
\vspace{1pt}

The transform rule can now be applied. It states that if $\lap\left\{f(t)\right\} = F(s)$, then $\lap\left\{e^{at} f(t)\right\} = F(s - a)$. So $F_n(s)$ becomes

\begin{equation}
     F_n(s - 1) = \frac{e^{-(n^2 - n)(s-1)}}{s-1} - \frac{e^{-(n^2 + n)(s-1)}}{s-1}
\end{equation}
\vspace{1pt}

therefore

\begin{equation}
     \lim_{n \to \infty} \big(\lap\{f_n\}\big) = \lim_{n \to \infty} \left(\frac{e^{-(n^2 - n)(s-1)}}{s-1} - \frac{e^{-(n^2 + n)(s-1)}}{s-1}\right)
\end{equation}
\vspace{1pt}

Then, by the linearity rule

\begin{equation}
     \lim_{n \to \infty} \big(\lap\{f_n\}\big) = \lim_{n \to \infty} \left(\frac{e^{-(n^2 - n)(s-1)}}{s-1}\right) - \lim_{n \to \infty}\left(\frac{e^{-(n^2 + n)(s-1)}}{s-1}\right)
\end{equation}
\vspace{1pt}

Evaluate the first limit with the limit chain rule. Let $u(n) = n^2 - n$ and $G(s - 1) = \frac{e^{-u(s - 1)}}{s - 1}$

\begin{equation}
     \lim_{n \to \infty} (n^2 - n) \to \infty
\end{equation}
\vspace{1pt}

Then it can be seen that

\begin{equation}
     \lim_{n \to \infty} = \frac{e^{-\infty(s - 1)}}{s - 1} \to \text{Undefined}
\end{equation}
\vspace{1pt}

since $\infty(s - 1)$ is undefined. Therefore

\begin{equation}\label{eq:lim_Fn}
     \lim_{n \to \infty} \big(\lap\{f_n\}\big) = \lim_{n \to \infty} \left(\frac{e^{-(n^2 - n)(s-1)}}{s-1} - \frac{e^{-(n^2 + n)(s-1)}}{s-1}\right) \to \text{Undefined}
\end{equation}
\vspace{1pt}

Equations \ref{eq:F} and \ref{eq:lim_Fn} show that \ref{eq:pntwise_lap} is not true for the example in \ref{eq:fn}. Therefore it can be concluded that for a sequence of time-domain functions $f_n$, equation \ref{eq:pntwise_lap} is only true if $\lim_{n \to \infty} (\lap\{f_n\})$ converges.

\end{document}




